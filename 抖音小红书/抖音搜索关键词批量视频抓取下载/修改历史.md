# 修改历史（抖音搜索关键词批量视频抓取下载）

> 目录：`抖音小红书/抖音搜索关键词批量视频抓取下载/`

## 2025-08-17

- 新增：`生成_douyin_cookies_selenium.py`
  - 作用：使用 Selenium 启动 Chrome，引导登录抖音后，一键导出同目录 `cookies.json`（结构 `{ "cookies": [...] }`），与 `抖音.py` 的 Cookie 注入逻辑完全兼容。
  - 参数：
    - `--user-data-dir`（可选）：指定 Chrome 用户数据目录，便于持久化登录。
    - `--headless` / `--no-headless`：是否无头（默认可视化，便于扫码登录）。
    - `--wait-minutes`：等待登录的最长分钟数（默认 10）。
  - 行为：在限定时间内检测到 `sessionid/sid_ucp_v1/sid_tt/uid_tt/uid_tt_ss` 等关键 Cookie 即视为已登录并导出；若超时未登录也会导出当前 Cookie（可能仅匿名态）。
  - 兼容：优先使用 Selenium Manager 自动管理驱动；若失败，自动回退尝试项目根目录 `chromedriver.exe`。

- 说明：
  - 本次新增不修改 `抖音.py`，避免与现有逻辑冲突。
  - 已遵循约定：新增功能独立成脚本，并在本目录记录本修改历史。

## 使用建议

1. 首次运行：
   ```powershell
   # 安装依赖
   pip install -U selenium

   # 运行（推荐可视化方式扫码登录）
   python 生成_douyin_cookies_selenium.py --no-headless
   ```

2. 如需持久化登录并与其他工具共享浏览器数据：
   ```powershell
   python 生成_douyin_cookies_selenium.py --user-data-dir "../chrome_user_data" --no-headless
   ```

3. 生成完成后，直接运行 `抖音.py` 即可复用 `cookies.json`。
